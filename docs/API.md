# API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## GET /api/market

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|-------------|----------|
| `format` | string | `json` | –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: `json` –∏–ª–∏ `html` |
| `currency` | string | –≤—Å–µ | –§–∏–ª—å—Ç—Ä –ø–æ –≤–∞–ª—é—Ç–µ: `gold` –∏–ª–∏ `cookie` |
| `product_id` | string | –≤—Å–µ | ID —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: `1,2,3` |
| `days` | int | `30` | –ó–∞ —Å–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–Ω–µ–π |

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

```
GET /api/market
GET /api/market?format=html
GET /api/market?currency=gold
GET /api/market?currency=cookie&format=html
GET /api/market?product_id=5,12,33
GET /api/market?currency=gold&days=7
GET /api/market?product_id=1,2&currency=gold&format=json
```

---

### –û—Ç–≤–µ—Ç JSON

```json
{
    "meta": {
        "days": 30,
        "currency": "gold",
        "total": 142,
        "generated": "2026-02-17T12:00:00+00:00"
    },
    "data": [
        {
            "product_id": 5,
            "product_name": "–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–≤–∏—Ç–æ–∫ –∑–∞—Ç–æ—á–∫–∏ [III]",
            "product_icon": "üîñ",
            "full_name": "üîñ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–≤–∏—Ç–æ–∫ –∑–∞—Ç–æ—á–∫–∏ [III]",
            "currency": "gold",
            "buy": {
                "price": 600,
                "currency": "gold",
                "posted_at": "2026-02-16T14:30:00+00:00",
                "tg_link": "https://t.me/epsilionwar_trade/12345",
                "user_display": "@trader_nick",
                "user_tg_link": "https://t.me/trader_nick",
                "status": "ok"
            },
            "sell": {
                "price": 750,
                "currency": "gold",
                "posted_at": "2026-02-17T09:15:00+00:00",
                "tg_link": "https://t.me/epsilionwar_trade/12400",
                "user_display": "@seller_name",
                "user_tg_link": "https://t.me/seller_name",
                "status": "ok"
            }
        },
        {
            "product_id": 8,
            "product_name": "–ü–∏—Ä–æ–≥ [IV] - 7 –¥–Ω–µ–π",
            "product_icon": "ü•Æ",
            "full_name": "ü•Æ –ü–∏—Ä–æ–≥ [IV] - 7 –¥–Ω–µ–π",
            "currency": "gold",
            "buy": {
                "price": 3500,
                "currency": "gold",
                "posted_at": "2026-02-15T11:00:00+00:00",
                "tg_link": "https://t.me/epsilionwar_trade/12200",
                "user_display": "–ò–≤–∞–Ω",
                "user_tg_link": null,
                "status": "ok"
            },
            "sell": null
        }
    ]
}
```

### –ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞

**`meta`**
- `days` ‚Äî –ø–µ—Ä–∏–æ–¥ –≤—ã–±–æ—Ä–∫–∏ –≤ –¥–Ω—è—Ö
- `currency` ‚Äî —Ñ–∏–ª—å—Ç—Ä –≤–∞–ª—é—Ç—ã (`all` –µ—Å–ª–∏ –Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–æ—Å—å)
- `total` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
- `generated` ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞

**`data[]`**
- `product_id` ‚Äî ID —Ç–æ–≤–∞—Ä–∞ (–æ—Å–Ω–æ–≤–Ω–æ–≥–æ, —Å —É—á—ë—Ç–æ–º `parent_id`)
- `product_name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- `product_icon` ‚Äî —ç–º–æ–¥–∑–∏ –∏–∫–æ–Ω–∫–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å `null`)
- `full_name` ‚Äî –∏–∫–æ–Ω–∫–∞ + –Ω–∞–∑–≤–∞–Ω–∏–µ
- `currency` ‚Äî –≤–∞–ª—é—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–∞
- `buy` ‚Äî –ª—É—á—à–µ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–æ–∫—É–ø–∫—É (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞), `null` –µ—Å–ª–∏ –Ω–µ—Ç
- `sell` ‚Äî –ª—É—á—à–µ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞), `null` –µ—Å–ª–∏ –Ω–µ—Ç

**`buy` / `sell`**
- `price` ‚Äî —Ü–µ–Ω–∞
- `currency` ‚Äî `gold` –∏–ª–∏ `cookie`
- `posted_at` ‚Äî –¥–∞—Ç–∞/–≤—Ä–µ–º—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è (ISO 8601)
- `tg_link` ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram (`null` –µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)
- `user_display` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è (@username –∏–ª–∏ –∏–º—è)
- `user_tg_link` ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å –≤ Telegram (`null` –µ—Å–ª–∏ –Ω–µ—Ç username)
- `status` ‚Äî —Å—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏: `ok`, `suspicious`, `needs_review`

---

### –û—Ç–≤–µ—Ç HTML

–ü—Ä–∏ `?format=html` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≥–æ—Ç–æ–≤–∞—è HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π.  
–£–¥–æ–±–Ω–∞ –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ HTML-–æ—Ç–≤–µ—Ç–∞:
- –ù–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å –≤ Telegram (–µ—Å–ª–∏ –µ—Å—Ç—å username)
- –î–∞—Ç–∞ ‚Äî –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—ã (`suspicious`) –≤—ã–¥–µ–ª–µ–Ω—ã –æ—Ä–∞–Ω–∂–µ–≤—ã–º —Ü–≤–µ—Ç–æ–º
- –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

---

### –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `200` | –£—Å–ø–µ—à–Ω–æ |
| `500` | –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

---

## –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–±—É–¥—É—â–µ–µ)

```
GET /api/market/history?product_id=5&days=90    # –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –ø–æ —Ç–æ–≤–∞—Ä—É
GET /api/market/report?date=2026-02-17          # –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç
GET /api/market/compare?date1=...&date2=...     # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö –¥–∞—Ç
GET /api/market/anomalies                       # –°–ø–∏—Å–æ–∫ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω
```
