# TG Market Parser ‚Äî Epsilion War

–ü–∞—Ä—Å–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–≥–æ Telegram-—á–∞—Ç–∞ –∏–≥—Ä—ã Epsilion War.  
–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ MadelineProto, –ø–∞—Ä—Å–∏—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–æ—á–Ω—ã—Ö —Ü–µ–Ω.

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–¥ —Å–≤–æ–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º Telegram —á–µ—Ä–µ–∑ MadelineProto
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü)
- –ü–∞—Ä—Å–∏–Ω–≥ –æ–±—ä—è–≤–ª–µ–Ω–∏–π: `#–ø—Ä–æ–¥–∞–º`, `#–∫—É–ø–ª—é`, `#–æ–±–º–µ–Ω`, `#—É—Å–ª—É–≥–∏` –∏ –∏—Ö –≤–∞—Ä–∏–∞—Ü–∏–∏
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –±–µ–∑ —Ö—ç—à—Ç–µ–≥–æ–≤ (–ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö –≤–∞–ª—é—Ç: üí∞ –∑–æ–ª–æ—Ç–æ –∏ üç™ –ø–µ—á–µ–Ω—å–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–µ–¥–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏–∫–æ–Ω–∫–∞–º–∏ –∏ –∞–ª–∏–∞—Å–∞–º–∏
- –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –ø–æ—Ä–æ–≥)
- REST API: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ JSON –∏ HTML

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
composer install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp .env.example .env
php artisan key:generate
```

–ó–∞–ø–æ–ª–Ω–∏ –≤ `.env`:
- `TELEGRAM_API_ID` –∏ `TELEGRAM_API_HASH` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ https://my.telegram.org
- `TELEGRAM_PHONE` ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–∞
- `TELEGRAM_CHAT_ID` ‚Äî ID –∏–ª–∏ username —á–∞—Ç–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö (—Å–º. [DATABASE.md](docs/DATABASE.md))

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

```sql
CREATE DATABASE telegram_parser CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE telegram_session CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 4. –ú–∏–≥—Ä–∞—Ü–∏–∏

```bash
php artisan migrate
```

### 5. –ü–µ—Ä–≤–∏—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Telegram

–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
php artisan telegram:fetch --login
```

–°–ª–µ–¥—É–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º: –≤–≤–µ–¥–∏ –∫–æ–¥ –∏–∑ SMS –∏–ª–∏ –∏–∑ –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ Telegram.

### 6. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

```bash
php artisan telegram:fetch
```

### 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)

```bash
# –ó–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–π —á–∞—Å
0 * * * * cd /path/to/project && php artisan telegram:fetch >> /dev/null 2>&1
```

---

## Artisan –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `php artisan telegram:fetch` | –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å |
| `php artisan telegram:fetch --login` | –ü–µ—Ä–≤–∏—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Telegram |
| `php artisan telegram:fetch --parse-only` | –¢–æ–ª—å–∫–æ –ø–∞—Ä—Å–∏—Ç—å —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è |

---

## API

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [API.md](docs/API.md)

```
GET /api/market
GET /api/market?format=html
GET /api/market?currency=gold
GET /api/market?currency=cookie
GET /api/market?product_id=1,2,3
GET /api/market?days=7
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [DATABASE.md](docs/DATABASE.md)

---

## –¢–µ—Å—Ç—ã

```bash
php artisan test
# –∏–ª–∏
./vendor/bin/phpunit
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
  Console/Commands/
    FetchTelegramMessages.php   # Artisan –∫–æ–º–∞–Ω–¥–∞
  Http/Controllers/
    MarketController.php        # API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
  Models/
    TgUser.php                  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram
    Product.php                 # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤
    Service.php                 # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —É—Å–ª—É–≥
    TgMessage.php               # –°—ã—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    Listing.php                 # –û–±—ä—è–≤–ª–µ–Ω–∏—è –∫—É–ø–ª–∏/–ø—Ä–æ–¥–∞–∂–∏
    ServiceListing.php          # –û–±—ä—è–≤–ª–µ–Ω–∏—è —É—Å–ª—É–≥
    Exchange.php                # –û–±—ä—è–≤–ª–µ–Ω–∏—è –æ–±–º–µ–Ω–∞
  Services/
    TelegramFetcher.php         # –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ MadelineProto
    MessageParser.php           # –ü–∞—Ä—Å–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
    MessageSaver.php            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    PriceAnomalyDetector.php    # –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π —Ü–µ–Ω
config/
  parser.php                   # –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä—Å–µ—Ä–∞
database/
  migrations/                  # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
docs/
  README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª
  DATABASE.md                  # –°—Ö–µ–º–∞ –ë–î
  API.md                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
  CONTEXT.md                   # –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏ –¥–ª—è AI
```
